(function(t){function e(e){for(var s,o,a=e[0],l=e[1],c=e[2],p=0,h=[];p<a.length;p++)o=a[p],Object.prototype.hasOwnProperty.call(r,o)&&r[o]&&h.push(r[o][0]),r[o]=0;for(s in l)Object.prototype.hasOwnProperty.call(l,s)&&(t[s]=l[s]);u&&u(e);while(h.length)h.shift()();return n.push.apply(n,c||[]),i()}function i(){for(var t,e=0;e<n.length;e++){for(var i=n[e],s=!0,a=1;a<i.length;a++){var l=i[a];0!==r[l]&&(s=!1)}s&&(n.splice(e--,1),t=o(o.s=i[0]))}return t}var s={},r={app:0},n=[];function o(e){if(s[e])return s[e].exports;var i=s[e]={i:e,l:!1,exports:{}};return t[e].call(i.exports,i,i.exports,o),i.l=!0,i.exports}o.m=t,o.c=s,o.d=function(t,e,i){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},o.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(o.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)o.d(i,s,function(e){return t[e]}.bind(null,s));return i},o.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="/cipher-studies/";var a=window["webpackJsonp"]=window["webpackJsonp"]||[],l=a.push.bind(a);a.push=e,a=a.slice();for(var c=0;c<a.length;c++)e(a[c]);var u=l;n.push([0,"chunk-vendors"]),i()})({0:function(t,e,i){t.exports=i("56d7")},"21bb":function(t,e,i){"use strict";var s=i("2dad"),r=i.n(s);r.a},"21f5":function(t,e,i){"use strict";var s=i("fe0d"),r=i.n(s);r.a},"2dad":function(t,e,i){},"318b":function(t,e,i){"use strict";var s=i("b6ec"),r=i.n(s);r.a},"56d7":function(t,e,i){"use strict";i.r(e);var s=i("2b0e"),r=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"app"}},[i("router-view"),i("div",{staticClass:"nav",attrs:{id:"nav"}},[i("div",{staticClass:"nav__Item"},[i("router-link",{staticClass:"nav__Link",attrs:{to:"/"}},[t._v("Home")])],1),i("div",{staticClass:"nav__Item"},[i("router-link",{staticClass:"nav__Link",attrs:{to:"/rows-transition"}},[t._v("Rows Transition")])],1),i("div",{staticClass:"nav__Item"},[i("router-link",{staticClass:"nav__Link",attrs:{to:"/bbs"}},[t._v("BBS")])],1)])],1)},n=[],o=(i("5c0b"),i("2877")),a={},l=Object(o["a"])(a,r,n,!1,null,null,null),c=l.exports,u=i("8c4f"),p=function(){var t=this,e=t.$createElement;t._self._c;return t._m(0)},h=[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"home"},[i("div",{staticClass:"home__Desc"},[i("h1",{staticClass:"home__Heading"},[t._v(" Cipher Studies ")]),i("p",{staticClass:"home__Paragraph"},[t._v(" This is studies project prepared for "),i("i",[t._v("Basics of Data Security")]),t._v(" lessons created by Szymon Grobelny. ")]),i("p",{staticClass:"home__Paragraph"},[t._v(" If you want test implementation of ciphers, algorithms etc. check navigation below. â†“ ")])])])}],d=(i("21bb"),{}),v=Object(o["a"])(d,p,h,!1,null,null,null),f=v.exports,m=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"rows-transition"},[i("h1",[t._v("Rows Transition")]),i("section",{staticClass:"section"},[i("div",{staticClass:"section__Label"},[t._v("Text Input:")]),i("div",{staticClass:"section__Item"},[i("textarea",{directives:[{name:"model",rawName:"v-model",value:t.inputString,expression:"inputString"}],attrs:{placeholder:"Max "+t.maxChars+" characters and only english characters are acceptable...",maxlength:t.maxChars,name:"rows-transition-input",cols:"30",rows:"10"},domProps:{value:t.inputString},on:{keypress:function(e){return t.limitChars(e)},input:function(e){e.target.composing||(t.inputString=e.target.value)}}})]),i("div",{staticClass:"section__Item"},[i("button",{staticClass:"button",on:{click:t.encryptString}},[t._v("Encrypt Text")]),i("button",{staticClass:"button",on:{click:t.decryptString}},[t._v("Decrypt Text")])]),i("div",{staticClass:"section__Label"},[t._v("Text Output:")]),i("div",{staticClass:"section__Item"},[i("textarea",{directives:[{name:"model",rawName:"v-model",value:t.outputString,expression:"outputString"}],attrs:{placeholder:"There will be output text. If you run decrypt text will be without spaces.",cols:"30",rows:"10"},domProps:{value:t.outputString},on:{input:function(e){e.target.composing||(t.outputString=e.target.value)}}})])]),i("div",{staticClass:"section__Item"},[i("label",{staticClass:"button"},[t._v(" Upload .txt file to encrypt "),i("input",{staticClass:"nativeFileInput",attrs:{type:"file"},on:{change:t.uploadFile}})]),i("a",{staticClass:"button",attrs:{href:"data:text/plain;charset=utf-8,"+encodeURIComponent(t.outputString),download:"encrypted_"+t.currentTime+".txt"}},[t._v(" Save decrypted text as .txt file ")])])])},g=[],b={data(){return{inputString:"",outputString:"",matrix:[],cipherKey:{colsArr:[4,8,1,7,3,6,5,2],colsAmount:8,rowsAmount:400}}},computed:{maxChars(){return this.cipherKey.colsAmount*this.cipherKey.rowsAmount},inputToEncryptString(){return this.inputString.toString().split(" ").join("+").trim()},inputToDecryptString(){return this.inputString.toString().split("+").join(" ")},currentTime(){let t=new Date,e=`${t.getFullYear()}-${t.getMonth()+1}-${t.getDate()}`,i=`${t.getHours()}${t.getMinutes()}${t.getSeconds()}`;return`${e}_${i}`}},methods:{limitChars:function(t){let e=t.key;/^[a-z\d .,:+]*$/i.test(e)||t.preventDefault()},createMatrix(){this.matrix=[];for(let t=0;t<this.cipherKey.rowsAmount;t++){this.matrix[t]=[];for(let e=0;e<this.cipherKey.colsAmount;e++)this.matrix[t][e]=null}},encryptString(){let t=0;this.createMatrix();for(let i=0;i<this.cipherKey.rowsAmount;i++)for(let e=0;e<this.cipherKey.colsAmount;e++)this.inputToEncryptString[t]&&(this.matrix[i][e]=this.inputToEncryptString[t]),t++;let e="";for(let i=0;i<this.cipherKey.colsAmount;i++)for(let t=0;t<this.cipherKey.rowsAmount;t++)this.matrix[t][this.cipherKey.colsArr[i]-1]&&(e=`${e}${this.matrix[t][this.cipherKey.colsArr[i]-1]}`);this.outputString=e},decryptString(){let t=Math.floor(this.inputToDecryptString.length/this.cipherKey.colsAmount),e=this.inputToDecryptString.length%this.cipherKey.colsAmount,i="",s=0;this.createMatrix();for(let r=0;r<this.cipherKey.colsAmount;r++){let i=this.cipherKey.colsArr[r]<=e?t+1:t;for(let t=0;t<i;t++)this.inputToDecryptString[s]&&(this.matrix[t][this.cipherKey.colsArr[r]-1]=this.inputToDecryptString[s],s++)}i=this.matrix.map(t=>t.join("")).join(""),this.outputString=i},uploadFile(t){const e=t.target.files[0],i=new FileReader;i.readAsText(e),i.onload=t=>this.$emit("load",this.inputString=t.target.result)}}},_=b,S=(i("21f5"),Object(o["a"])(_,m,g,!1,null,"ccf1c6ba",null)),y=S.exports,w=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"bbs"},[i("h1",[t._v("Blum Blum Shub")]),i("section",{staticClass:"section"},[i("div",{staticClass:"section__Label"},[t._v("Bits Series:")]),i("div",{staticClass:"section__Item"},[i("p",{staticClass:"smallText"},[t._v(t._s(t.bitsSeries?t.showBitsSeries:"You're not generate bits yet."))])]),i("div",{staticClass:"section__Label"},[t._v("Tests:")]),i("div",{staticClass:"section__Item"},[i("p",[t._v("Series test: "),i("strong",[t._v(t._s(t.test.series?"valid":"invalid"))])]),i("p",[t._v("Long Series test: "),i("strong",[t._v(t._s(t.test.longSeries?"valid":"invalid"))])]),i("p",[t._v("Single Bit test: "),i("strong",[t._v(t._s(t.test.singleBit?"valid":"invalid"))])]),i("p",[t._v("Poker test: "),i("strong",[t._v(t._s(t.test.poker?"valid":"invalid"))])])]),i("div",{staticClass:"section__Item"},[i("button",{staticClass:"button",on:{click:t.runBBS}},[t._v("RUN")])])])])},x=[],k=i("7409"),C=i.n(k),B={name:"BBS",data(){return{bitsAmount:2e4,bitsSeries:null,x0:0,n:0,prime:0,test:{series:!1,longSeries:!1,singleBit:!1,poker:!1}}},computed:{showBitsSeries(){return this.bitsSeries.toString().split(",").join("")}},methods:{generateBitsSeries(t){this.generateBlumNumber(),this.generateInitX(C()(this.n));let e=C()(this.x0).modPow(2,C()(this.n)),i=e,s=[];for(let r=1;r<=t;r++){let t=C()(i).modPow(2,C()(this.n));i=t;let e=0;e=C()(i).isEven()?0:1,s.push(e)}this.bitsSeries=s},generateBlumNumber(){let t,e=this.generateBigPrimeNumber(),i=this.generateBigPrimeNumber();t=C()(e).multiply(i),console.log(`Blum number is ${t}`),this.n=t},generateInitX(t){let e,i,s=C.a.zero,r=C()(2).pow(512);while(1)if(e=C.a.randBetween(s,r),C.a.gcd(e,t).equals(1)){i=e;break}console.log(`Init X0 number is ${i}`),this.x0=i},generateBigPrimeNumber(){let t,e,i=C.a.zero,s=C()(2).pow(512);while(1)if(t=C.a.randBetween(i,s),C()(t).isPrime()&&C()(t).value>1e4){e=t;break}return console.log(`Big prime number is ${e}`),e},singleBitTest(){let t=[...this.bitsSeries],e=0;t.forEach(t=>{1===t&&e++}),this.test.singleBit=!(e<9725||e>10275)},longSeriesTest(){let t=0,e=[...this.bitsSeries],i=e[0],s=!0;e.forEach((function(r,n){let o=e[n];o===i?(t++,t>=26&&(s=!1)):t=0,i=e[n-1]})),this.test.longSeries=s},seriesTest(){let t=[...this.bitsSeries],e=!1,i=[];for(let s=1;s<=6;s++)i[s]=0;t.forEach((function(e,s){let r=t[s],n=t[s-1],o=t[s-2],a=t[s-3],l=t[s-4],c=t[s-5],u=t[s-6];r===u&&r===c&&r===l&&r===a&&r===o&&r===n&&"undefined"!==typeof r&&(i[6]++,t[s]=void 0,t[s-1]=void 0,t[s-2]=void 0,t[s-3]=void 0,t[s-4]=void 0,t[s-5]=void 0,t[s-6]=void 0)})),t.forEach((function(e,s){let r=t[s],n=t[s-1],o=t[s-2],a=t[s-3],l=t[s-4],c=t[s-5];r===c&&r===l&&r===a&&r===o&&r===n&&"undefined"!==typeof r&&(i[5]++,t[s]=void 0,t[s-1]=void 0,t[s-2]=void 0,t[s-3]=void 0,t[s-4]=void 0,t[s-5]=void 0)})),t.forEach((function(e,s){let r=t[s],n=t[s-1],o=t[s-2],a=t[s-3],l=t[s-4];r===l&&r===a&&r===o&&r===n&&"undefined"!==typeof r&&(i[4]++,t[s]=void 0,t[s-1]=void 0,t[s-2]=void 0,t[s-3]=void 0,t[s-4]=void 0)})),t.forEach((function(e,s){let r=t[s],n=t[s-1],o=t[s-2],a=t[s-3];r===a&&r===o&&r===n&&"undefined"!==typeof r&&(i[3]++,t[s]=void 0,t[s-1]=void 0,t[s-2]=void 0,t[s-3]=void 0)})),t.forEach((function(e,s){let r=t[s],n=t[s-1],o=t[s-2];r===o&&r===n&&"undefined"!==typeof r&&(i[2]++,t[s]=void 0,t[s-1]=void 0,t[s-2]=void 0)})),t.forEach((function(e,s){let r=t[s],n=t[s-1];r===n&&"undefined"!==typeof r&&(i[1]++,t[s]=void 0,t[s-1]=void 0)})),i[1]>2315&&i[1]<2685&&i[2]>1114&&i[2]<1386&&i[3]>527&&i[3]<723&&i[4]>240&&i[4]<384&&i[5]>103&&i[5]<209&&i[6]>103&&i[6]<209&&(e=!0),console.log(i),this.test.series=e},pokerTest(){let t=[...this.bitsSeries],e=[],i=[],s=!1;for(let o=0;o<5e3;o++)e[o]=t.splice(0,4).toString().split(",").join("");for(let o=0;o<16;o++)i[o]=0;e.forEach(t=>{switch(t){case"0000":i[0]++;break;case"0001":i[1]++;break;case"0010":i[2]++;break;case"0011":i[3]++;break;case"0100":i[4]++;break;case"0101":i[5]++;break;case"0110":i[6]++;break;case"0111":i[7]++;break;case"1000":i[8]++;break;case"1001":i[9]++;break;case"1010":i[10]++;break;case"1011":i[11]++;break;case"1101":i[12]++;break;case"1110":i[13]++;break;case"1100":i[14]++;break;case"1111":i[15]++;break;default:break}});let r=0;i.forEach(t=>{r+=Math.pow(t,2)});let n=.0032*r-5e3;n>2.16&&n<46.17&&(s=!0),this.test.poker=s},runBBS(){let t=performance.now();this.generateBitsSeries(this.bitsAmount);let e=performance.now();console.log(`generateBitsSeries() function takes ${e-t} milliseconds`),this.singleBitTest(),this.longSeriesTest(),this.pokerTest(),this.seriesTest();let i=performance.now();console.log(`generateBitsSeries() with four FIPS 140-2 tests takes ${i-t} milliseconds`)}}},T=B,$=(i("318b"),Object(o["a"])(T,w,x,!1,null,"7ae08436",null)),A=$.exports;s["a"].use(u["a"]);const j=[{path:"/",name:"Home",component:f},{path:"/rows-transition",name:"rows-transition",component:y},{path:"/bbs",name:"BBS",component:A}],E=new u["a"]({routes:j});var I=E;s["a"].config.productionTip=!1,new s["a"]({router:I,render:function(t){return t(c)}}).$mount("#app")},"5c0b":function(t,e,i){"use strict";var s=i("9c0c"),r=i.n(s);r.a},"9c0c":function(t,e,i){},b6ec:function(t,e,i){},fe0d:function(t,e,i){}});
//# sourceMappingURL=app.ce4fbbad.js.map